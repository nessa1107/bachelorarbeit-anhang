import os
import random
import matplotlib.pyplot as plt
from PIL import Image

modus = "ganimal"

modus = \
    input(f"Do you want to guess pictures of pop art or ganimals? Enter 'ganimal' or 'popart', please.").strip().lower()

if modus == "ganimal" or modus == "popart":
    ai_dir = modus+"Images/ai_images"
    drawn_dir = modus+"Images/drawn_images"
else:
    print(f"Invalid input! Standard mode will be used! (Ganimal)")
    ai_dir = "ganimalImages/ai_images"
    drawn_dir = "ganimalImages/drawn_images"


num_samples = 5


def load_images_from_directory(directory, label, num_samples):
    all_files = [os.path.join(directory, file) for file in os.listdir(directory) if
                 file.endswith(('.png', '.jpg', '.jpeg'))]
    selected_files = random.sample(all_files, num_samples)
    return [(file, label) for file in selected_files]


example_drawn = random.choice([
    os.path.join(drawn_dir, file) for file in os.listdir(drawn_dir) if file.endswith(('.png', '.jpg', '.jpeg'))
])

example_image = Image.open(example_drawn)
plt.imshow(example_image, cmap=None)
plt.axis('off')
plt.show()
input(f"Here is an example of a drawn image:")

ai_images = load_images_from_directory(ai_dir, "AI", num_samples)

drawn_files = [
    os.path.join(drawn_dir, file) for file in os.listdir(drawn_dir) if file.endswith(('.png', '.jpg', '.jpeg'))
]
drawn_files.remove(example_drawn)
drawn_images = [(file, "drawn") for file in random.sample(drawn_files, num_samples)]

images = ai_images + drawn_images
random.shuffle(images)

user_answers = {}
correct = 0
for img_info in images:
    bild = Image.open(img_info[0])

    plt.imshow(bild, cmap=None)
    plt.axis('off')
    plt.show()

    answer = input(f"Is the image 'drawn' or 'AI'? ").strip().lower()
    user_answers[img_info[0]] = answer


correct = 0
print("\nEvaluation:")
for img_info in images:
    original_typ = img_info[1]
    user_guess = user_answers[img_info[0]]
    correct_flag = (user_guess.lower() == original_typ.lower())
    correct += correct_flag
    print(f"Image: {os.path.basename(img_info[0])} | Correct: {original_typ} | "
          f"Your answer: {user_guess} | {'✔️' if correct_flag else '❌'}")

print(f"\nResult: {correct} out of {len(images)} correct!")
